Homework 6
================
Hongji Jiang

# Problem 2

## Import and tidy up the dataset

``` r
homicide_data = read_csv("./data/homicide-data.csv")
```

    ## Rows: 52179 Columns: 12
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (9): uid, victim_last, victim_first, victim_race, victim_age, victim_sex...
    ## dbl (3): reported_date, lat, lon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

This dataset has 52179 rows and 12 columns. The columns(variables) are
uid, reported_date, victim_last, victim_first, victim_race, victim_age,
victim_sex, city, state, lat, lon, disposition and each row is a
homicide incident.

``` r
homicide_data=
  homicide_data %>%
  mutate(
    city_state = str_c(city, state, sep = ", "),
    solved = ifelse(disposition == "Closed by arrest", 1, 0),
    victim_age = as.numeric(victim_age)
    ) %>%
    filter(city_state != "Dallas, Tx", city_state != "Phoenix, AZ", city_state != "Kansas City, MO", city_state != "Tulsa, AL") %>% 
  filter(victim_race %in% c("Black", "White")) %>% 
  drop_na(victim_age)
```

Created a new variable `city_state` by concatenating city and state,
seperateing with ‘,’.

``` r
logistic_Baltimore = 
  homicide_data %>% 
  filter(city_state == "Baltimore, MD") %>% 
  glm(solved ~ victim_age + victim_sex + victim_race, data = ., family = binomial()) 
```

``` r
logistic_Baltimore %>% 
  broom::glance()
```

    ## # A tibble: 1 × 8
    ##   null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs
    ##           <dbl>   <int>  <dbl> <dbl> <dbl>    <dbl>       <int> <int>
    ## 1         3568.    2752 -1746. 3501. 3524.    3493.        2749  2753

``` r
logistic_Baltimore %>% 
  broom::tidy() %>%
  mutate(OR = exp(estimate)) %>%
  mutate(
    lower_ci = exp(estimate-1.96*std.error),
    upper_ci = exp(estimate+1.96*std.error)
  ) %>% 
  knitr::kable(digits = 3)
```

| term             | estimate | std.error | statistic | p.value |    OR | lower_ci | upper_ci |
|:-----------------|---------:|----------:|----------:|--------:|------:|---------:|---------:|
| (Intercept)      |    0.310 |     0.171 |     1.810 |   0.070 | 1.363 |    0.975 |    1.907 |
| victim_age       |   -0.007 |     0.003 |    -2.024 |   0.043 | 0.993 |    0.987 |    1.000 |
| victim_sexMale   |   -0.854 |     0.138 |    -6.184 |   0.000 | 0.426 |    0.325 |    0.558 |
| victim_raceWhite |    0.842 |     0.175 |     4.818 |   0.000 | 2.320 |    1.648 |    3.268 |
